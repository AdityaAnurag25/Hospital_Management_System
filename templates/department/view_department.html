{% extends 'layout.html' %}

{% block title %}
    HMS - Dept of {{department.name}}
{% endblock %}

{% block content %}

    {% if session['role'] == 'admin' %}
        <div class ="d-flex justify-content-between align-items-center mb-4">
            <h2 class="display-5 fw-medium">
                <p class="text-info-emphasis">Department of {{department.name}}</p>
            </h2>
            
            <div>
                <a href="{{url_for('add_doctor', id = department.id)}}" class="btn btn-success">Add Doctor</a>
                <a href="{{url_for('edit_department', id = department.id)}}" class="btn btn-warning">Edit Department</a>
            </div>
        </div>
    {% else %}
        <h2 align = 'center' class="display-5 fw-medium">
            <p class="text-info-emphasis">Department of {{department.name}}</p>
        </h2>
    {% endif %}

    <table name = "info" class="table" border>
        <thead>
            <tr>
                <th>Details</th>
                <th></th>
            </tr>
            <body>
                <tr>
                    <td><strong>Department ID</strong> : {{department.id}} </td>
                    <td><strong>Department Name</strong> : {{department.name}} </td>
                </tr>
                <tr>
                    <td><strong>Description</strong> : {{department.description}} </td>
                    {% if session['role'] == 'admin' %}
                        <td><strong>Number of Doctors</strong> : {{department.doctors|count}} </td>    
                    {% endif %}
                    
                </tr>
            </body>
        </thead>
    </table>


    <h3 align = 'center' class="display-6 fw-medium">
        <p class="text-info-emphasis">Doctors in this Department</p>
    </h3>
    <table name = "department" class="table" border = True>
         <thead>
            <tr>
                <th>Doctor ID</th>
                <th>Doctor Name</th>
                <th>Actions</th>
            </tr>
            <body>
                {% for doctor in doctors %}
                    <tr>
                        <td>{{doctor.id}}</td>
                        <td>{{doctor.name}}</td>
                        <td>
                            <a href = "{{url_for('profile', id = doctor.id, role = 'doctor')}}" class="btn btn-info"> Details </a>

                            {% if session['role'] == 'admin' or session['role'] == 'patient' %}
                                <a href = "{{url_for('book_appointment', doctor_id = doctor.id)}}" class="btn btn-success">Book Appointment</a>
                            {% endif %}
                            
                            {% if session['role'] == 'admin' %}
                                <a href = "{{url_for('doctor_availability', id = doctor.id)}}" class="btn btn-secondary">Availability</a>
                                <a href = "{{url_for('edit_profile', id = doctor.id, role = 'doctor')}}" class="btn btn-warning">Edit</a>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </body>
         </thead>
    </table>
{% endblock %}